<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>G√°bor saj√°t szak√°csk√∂nyve 2026</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    .container { max-width: 1200px; margin: 0 auto; }
    header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 40px 30px;
      border-radius: 15px;
      margin-bottom: 30px;
      text-align: center;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    h1 { font-size: 2.5em; margin-bottom: 10px; }
    .controls {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
    }
    .control-section {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    .search-box {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 16px;
    }
    .checkbox-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }
    label {
      background: #f0f4ff;
      padding: 6px 12px;
      border-radius: 15px;
      cursor: pointer;
      font-size: 0.9em;
      transition: 0.3s;
      border: 1px solid #d0d7de;
    }
    label:has(input:checked) {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }
    input[type="checkbox"] { display: none; }
    
    .recipes {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 25px;
    }
    .recipe-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      transition: transform 0.2s;
    }
    .recipe-card:hover { transform: translateY(-5px); }
    .recipe-image {
      width: 100%;
      height: 180px;
      background: #eee;
      object-fit: cover;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3em;
    }
    .recipe-content { padding: 20px; flex-grow: 1; }
    .recipe-title { font-size: 1.3em; font-weight: bold; margin-bottom: 8px; color: #333; }
    .recipe-meta { color: #667eea; font-weight: 500; font-size: 0.85em; margin-bottom: 10px; text-transform: uppercase; }
    .tag-container { margin-bottom: 12px; }
    .tag {
      display: inline-block;
      background: #e8f0fe;
      color: #1a73e8;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 0.8em;
      margin-right: 5px;
      margin-bottom: 5px;
    }
    .recipe-ingredients {
      font-size: 0.9em;
      color: #555;
      background: #f9f9f9;
      padding: 10px;
      border-radius: 6px;
      margin-top: 10px;
      border-left: 3px solid #667eea;
    }
    .recipe-link {
      display: inline-block;
      margin-top: 15px;
      color: #764ba2;
      text-decoration: none;
      font-weight: bold;
      border-bottom: 2px solid transparent;
      transition: 0.3s;
    }
    .recipe-link:hover { border-bottom-color: #764ba2; }
    .no-results { text-align: center; padding: 40px; grid-column: 1/-1; color: #666; }
    
    @media (max-width: 768px) {
      .controls { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

  <div class="container">
    <header>
      <h1>üç≥ G√°bor szak√°csk√∂nyve 2026</h1>
      <p>Friss receptek a Google T√°bl√°zatb√≥l</p>
    </header>

    <div class="controls">
      <div class="control-section">
        <h3>üîç Keres√©s</h3>
        <input type="text" id="searchInput" class="search-box" placeholder="N√©v, hozz√°val√≥ vagy #hashtag...">
      </div>
      <div class="control-section">
        <h3>üè∑Ô∏è Kateg√≥ria sz≈±r≈ë</h3>
        <div class="checkbox-group" id="categoryFilter">
          <em>Bet√∂lt√©s...</em>
        </div>
      </div>
    </div>

    <div id="recipesContainer" class="recipes">
      <div class="no-results">Receptek bet√∂lt√©se a t√°bl√°zatb√≥l...</div>
    </div>
  </div>

  <script>
    const SHEET_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSA0efaKVbz-LL31DrKXrxbMo-4hKTb36ZzpjYXY7laLH5AmJGKiQp2FqvtQh8mj3TV6Mo995225hYr/pub?output=csv';

    let allRecipes = [];

    // CSV Parser
    function parseCSV(csvText) {
      const lines = [];
      let currentLine = [];
      let currentField = '';
      let inQuotes = false;

      for (let i = 0; i < csvText.length; i++) {
        const char = csvText[i];
        if (char === '"') inQuotes = !inQuotes;
        else if (char === ',' && !inQuotes) {
          currentLine.push(currentField.trim());
          currentField = '';
        } else if ((char === '\r' || char === '\n') && !inQuotes) {
          if (currentField || currentLine.length > 0) {
            currentLine.push(currentField.trim());
            lines.push(currentLine);
            currentLine = [];
            currentField = '';
          }
        } else {
          currentField += char;
        }
      }
      if (currentField || currentLine.length > 0) {
        currentLine.push(currentField.trim());
        lines.push(currentLine);
      }

      const headers = lines[0];
      return lines.slice(1).map(row => {
        const obj = {};
        headers.forEach((header, i) => {
          obj[header] = row[i] || '';
        });
        return obj;
      }).filter(r => r['Recept neve']);
    }

    async function loadRecipes() {
      try {
        const response = await fetch(SHEET_CSV_URL);
        const text = await response.text();
        allRecipes = parseCSV(text);
        
        renderFilters();
        // Az els≈ë bet√∂lt√©skor mindenkit mutatunk
        filterRecipes(); 
      } catch (err) {
        console.error("Hiba:", err);
        document.getElementById('recipesContainer').innerHTML = "Hiba az adatok el√©r√©sekor. Ellen≈ërizd a t√°bl√°zat k√∂zz√©t√©tel√©t!";
      }
    }

    function renderFilters() {
      const categories = [...new Set(allRecipes.map(r => r['Kateg√≥ria']).filter(Boolean))].sort();
      const filterDiv = document.getElementById('categoryFilter');
      
      if (categories.length === 0) {
        filterDiv.innerHTML = '<em>Nincsenek kateg√≥ri√°k a t√°bl√°zatban.</em>';
        return;
      }

      filterDiv.innerHTML = categories.map(cat => `
        <label>
          <input type="checkbox" value="${cat}" onchange="filterRecipes()">
          ${cat}
        </label>
      `).join('');
    }

    function renderRecipes(recipes) {
      const container = document.getElementById('recipesContainer');
      if (recipes.length === 0) {
        container.innerHTML = '<div class="no-results">Nincs a keres√©snek megfelel≈ë recept.</div>';
        return;
      }

      container.innerHTML = recipes.map(r => {
        const img = r['K√©p'] ? `<img src="${r['K√©p']}" class="recipe-image" alt="Recept">` : `<div class="recipe-image">üçΩÔ∏è</div>`;
        
        return `
          <div class="recipe-card">
            ${img}
            <div class="recipe-content">
              <div class="recipe-meta">${r['Kateg√≥ria'] || 'Egy√©b'} ${r['Cuisine'] ? ' | ' + r['Cuisine'] : ''}</div>
              <div class="recipe-title">${r['Recept neve']}</div>
              
              <div class="tag-container">
                ${r['#Hashtag'] ? r['#Hashtag'].split(' ').map(tag => `<span class="tag">${tag}</span>`).join('') : ''}
                ${String(r['Gyors']).toUpperCase() === 'IGEN' ? '<span class="tag" style="background:#fff3cd; color:#856404;">‚ö° Gyors</span>' : ''}
                ${String(r['Egyszer≈±']).toUpperCase() === 'IGEN' ? '<span class="tag" style="background:#d4edda; color:#155724;">‚úÖ Egyszer≈±</span>' : ''}
              </div>

              <div class="recipe-ingredients">
                <strong>Hozz√°val√≥k:</strong><br>
                ${r['Hozz√°val√≥k'] ? r['Hozz√°val√≥k'].substring(0, 120) + '...' : 'R√©szletek a linken.'}
              </div>

              ${r['URL'] ? `<a href="${r['URL']}" target="_blank" class="recipe-link">Megnyit√°s (${r['Platform'] || 'Forr√°s'}) ‚Üí</a>` : ''}
            </div>
          </div>
        `;
      }).join('');
    }

    function filterRecipes() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const selectedCats = Array.from(document.querySelectorAll('#categoryFilter input:checked')).map(i => i.value);

      const filtered = allRecipes.filter(r => {
        const matchesSearch = 
          (r['Recept neve'] || '').toLowerCase().includes(searchTerm) ||
          (r['Hozz√°val√≥k'] || '').toLowerCase().includes(searchTerm) ||
          (r['#Hashtag'] || '').toLowerCase().includes(searchTerm);
        
        // Ha semmi nincs kipip√°lva, akkor minden kateg√≥ria j√∂het
        const matchesCat = selectedCats.length === 0 || selectedCats.includes(r['Kateg√≥ria']);
        
        return matchesSearch && matchesCat;
      });

      renderRecipes(filtered);
    }

    document.getElementById('searchInput').addEventListener('input', filterRecipes);

    loadRecipes();
    // 5 percenk√©nt friss√≠t a h√°tt√©rben
    setInterval(loadRecipes, 300000);
  </script>
</body>
</html>
